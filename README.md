# Auth-JS ğŸ”

×©×¨×ª ××™××•×ª (Authentication Server) ×‘× ×•×™ ×‘-Node.js ×¢× Express ×•-MongoDB.

## ğŸ“‹ ×ª×•×›×Ÿ ×¢× ×™×™× ×™×

- [×¡×§×™×¨×” ×›×œ×œ×™×ª](#×¡×§×™×¨×”-×›×œ×œ×™×ª)
- [××¨×›×™×˜×§×˜×•×¨×”](#××¨×›×™×˜×§×˜×•×¨×”)
- [××‘× ×” ×”×ª×™×§×™×•×ª](#××‘× ×”-×”×ª×™×§×™×•×ª)
- [×”×ª×§× ×”](#×”×ª×§× ×”)
- [API Endpoints](#api-endpoints)
- [×˜×›× ×•×œ×•×’×™×•×ª](#×˜×›× ×•×œ×•×’×™×•×ª)

---

## ğŸ¯ ×¡×§×™×¨×” ×›×œ×œ×™×ª

××¢×¨×›×ª ××™××•×ª ××œ××” ×”×›×•×œ×œ×ª:
- **×”×¨×©××ª ××©×ª××©×™×** (Sign In) - ×™×¦×™×¨×ª ×—×©×‘×•×Ÿ ×—×“×©
- **×”×ª×—×‘×¨×•×ª** (Login) - ×§×‘×œ×ª JWT Token
- **×”×’× ×” ×¢×œ Routes** - Middleware ×œ××™××•×ª ×˜×•×§×Ÿ
- **×”×¦×¤× ×ª ×¡×™×¡×××•×ª** - ×©×™××•×© ×‘-bcrypt

---

## ğŸ—ï¸ ××¨×›×™×˜×§×˜×•×¨×”

×”×¤×¨×•×™×§×˜ ×‘× ×•×™ ×œ×¤×™ **××¨×›×™×˜×§×˜×•×¨×ª ×©×›×‘×•×ª (Layered Architecture)** ×¢× **Dependency Injection**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CLIENT REQUEST                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SERVER (server.js)                      â”‚
â”‚         Express App, Middleware, Route Registration         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ROUTES (routes/)                         â”‚
â”‚            ×”×’×“×¨×ª × ×ª×™×‘×™× ×•×©×™×•×š ×œ-Controllers                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 MIDDLEWARES (middlewares/)                  â”‚
â”‚              ××™××•×ª Token, ×œ×•×’×™×, ×•×œ×™×“×¦×™×”                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                CONTROLLERS (controllers/)                   â”‚
â”‚           ×§×‘×œ×ª Request, ×©×œ×™×—×ª Response                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SERVICES (services/)                       â”‚
â”‚              ×œ×•×’×™×§×” ×¢×¡×§×™×ª, ×”×¦×¤× ×”, ×™×¦×™×¨×ª Token               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   REPOS (repos/)                            â”‚
â”‚              ×’×™×©×” ×œ×‘×¡×™×¡ ×”× ×ª×•× ×™× (MongoDB)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INFRA (infra/)                           â”‚
â”‚                ×—×™×‘×•×¨ ×œ-MongoDB, ×§×•× ×¤×™×’×•×¨×¦×™×”                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ Dependency Injection Container

×”×¤×¨×•×™×§×˜ ××©×ª××© ×‘-**Container Pattern** ×œ× ×™×”×•×œ ×ª×œ×•×™×•×ª:

```javascript
// container.js
function createContainer(){
  const usersRepo = createUsersRepo()      // ×©×›×‘×ª × ×ª×•× ×™×
  const usersService = createUsersService(usersRepo)  // ×œ×•×’×™×§×” ×¢×¡×§×™×ª
  return {usersRepo, usersService}
}
```

**×™×ª×¨×•× ×•×ª:**
- ğŸ§ª ×§×œ ×œ×‘×“×™×§×•×ª (× ×™×ª×Ÿ ×œ×”×—×œ×™×£ ×œ-Mock)
- ğŸ”Œ ×”×¤×¨×“×ª ×ª×œ×•×™×•×ª ×‘×¨×•×¨×”
- ğŸ”„ ×’××™×©×•×ª ×‘×”×—×œ×¤×ª ××™××•×©×™×

---

## ğŸ“ ××‘× ×” ×”×ª×™×§×™×•×ª

```
auth/
â”œâ”€â”€ server.js              # Entry Point - ×”×¤×¢×œ×ª ×”×©×¨×ª
â”œâ”€â”€ container.js           # DI Container - × ×™×”×•×œ ×ª×œ×•×™×•×ª
â”œâ”€â”€ package.json           # ×”×’×“×¨×•×ª ×•×ª×œ×•×™×•×ª
â”‚
â”œâ”€â”€ controllers/           # ğŸ® Controllers
â”‚   â””â”€â”€ auth.controller.js # ×˜×™×¤×•×œ ×‘-Request/Response
â”‚
â”œâ”€â”€ services/              # âš™ï¸ Business Logic
â”‚   â””â”€â”€ auth.service.js    # ×œ×•×’×™×§×” ×¢×¡×§×™×ª, ×”×¦×¤× ×”, JWT
â”‚
â”œâ”€â”€ repos/                 # ğŸ’¾ Data Access Layer
â”‚   â””â”€â”€ users.repo.js      # ×¤×¢×•×œ×•×ª CRUD ×¢×œ MongoDB
â”‚
â”œâ”€â”€ routes/                # ğŸ›£ï¸ Routes
â”‚   â””â”€â”€ auth.route.js      # ×”×’×“×¨×ª × ×ª×™×‘×™ API
â”‚
â”œâ”€â”€ middlewares/           # ğŸ›¡ï¸ Middlewares
â”‚   â””â”€â”€ auth.middleware.js # ××™××•×ª JWT Token
â”‚
â”œâ”€â”€ infra/                 # ğŸ”§ Infrastructure
â”‚   â””â”€â”€ mongoConnection.js # ×—×™×‘×•×¨ MongoDB
â”‚
â”œâ”€â”€ utils/                 # ğŸ”¨ Utilities
â”‚   â”œâ”€â”€ utils.js           # Custom Error Class
â”‚   â””â”€â”€ createsecretkey.js # ×™×¦×™×¨×ª ××¤×ª×— ×¡×•×“×™
â”‚
â””â”€â”€ tests/                 # ğŸ§ª Tests
    â”œâ”€â”€ index.js           # ×¤×•× ×§×¦×™×•×ª ×œ×‘×“×™×§×”
    â”œâ”€â”€ index.test.js      # ×‘×“×™×§×•×ª ×™×—×™×“×”
    â””â”€â”€ package.json
```

---

## ğŸš€ ×”×ª×§× ×”

### ×“×¨×™×©×•×ª ××§×“×™××•×ª
- Node.js 18+
- MongoDB

### ×©×œ×‘×™ ×”×ª×§× ×”

```bash
# 1. ×©×›×¤×•×œ ×”×¤×¨×•×™×§×˜
git clone <repo-url>
cd auth

# 2. ×”×ª×§× ×ª ×ª×œ×•×™×•×ª
npm install

# 3. ×™×¦×™×¨×ª ×§×•×‘×¥ .env
# ×”×•×¡×£ ××ª ×”××©×ª× ×™× ×”×‘××™×:
MONGO_URI=mongodb://localhost:27017
SECRET_KEY=your-secret-key-here

# 4. ×”×¤×¢×œ×ª ×”×©×¨×ª (development)
npm run dev

# 5. ×”×¤×¢×œ×ª ×”×©×¨×ª (production)
npm start
```

### ×™×¦×™×¨×ª ××¤×ª×— ×¡×•×“×™

```bash
node utils/createsecretkey.js
```

---

## ğŸ“¡ API Endpoints

### Base URL: `http://localhost:8000/api/auth`

| Method | Endpoint   | ×ª×™××•×¨              | Body                              | Auth Required |
|--------|------------|--------------------|------------------------------------|---------------|
| POST   | `/signin`  | ×”×¨×©××ª ××©×ª××© ×—×“×©   | `{ username, password }`          | âŒ            |
| POST   | `/login`   | ×”×ª×—×‘×¨×•×ª ×•×§×‘×œ×ª Token | `{ username, password }`          | âŒ            |
| GET    | `/profile` | ×§×‘×œ×ª ×¤×¨×˜×™ ××©×ª××©   | -                                  | âœ…            |

### ×“×•×’×××•×ª

#### ×”×¨×©××” (Sign In)
```bash
curl -X POST http://localhost:8000/api/auth/signin \
  -H "Content-Type: application/json" \
  -d '{"username": "user1", "password": "pass123"}'
```

**Response:**
```json
{
  "msg": "user created",
  "user": {
    "_id": "...",
    "username": "user1"
  }
}
```

#### ×”×ª×—×‘×¨×•×ª (Login)
```bash
curl -X POST http://localhost:8000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "user1", "password": "pass123"}'
```

**Response:**
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

#### ×¤×¨×•×¤×™×œ (××•×’×Ÿ)
```bash
curl http://localhost:8000/api/auth/profile \
  -H "Authorization: Bearer <token>"
```

---

## ğŸ”’ ××‘×˜×—×”

| ×ª×—×•× | ××™××•×© |
|------|-------|
| ×”×¦×¤× ×ª ×¡×™×¡×××•×ª | bcrypt ×¢× salt factor 12 |
| ××™××•×ª | JWT Token (×ª×•×§×£: ×©×¢×”) |
| ×× ×™×¢×ª ×›×¤×™×œ×•×™×•×ª | Unique Index ×¢×œ username |
| Error Handling | Custom Error Class ×¢× Status Code |

---

## ğŸ› ï¸ ×˜×›× ×•×œ×•×’×™×•×ª

| ×˜×›× ×•×œ×•×’×™×” | ×ª×¤×§×™×“ |
|-----------|--------|
| **Express 5** | Web Framework |
| **MongoDB 7** | ×‘×¡×™×¡ × ×ª×•× ×™× |
| **bcryptjs** | ×”×¦×¤× ×ª ×¡×™×¡×××•×ª |
| **jsonwebtoken** | ×™×¦×™×¨×ª JWT Tokens |
| **dotenv** | ××©×ª× ×™ ×¡×‘×™×‘×” |
| **nodemon** | Hot Reload ×‘×¤×™×ª×•×— |

---

## ğŸ“Š ×ª×¨×©×™× ×–×¨×™××” - ×ª×”×œ×™×š ×”×ª×—×‘×¨×•×ª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     POST /login      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   Router   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   {user, pass}      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Controller â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚  Service   â”‚
                                 â”‚ - validate â”‚
                                 â”‚ - compare  â”‚
                                 â”‚ - sign JWT â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚    Repo    â”‚
                                 â”‚ findByUser â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚  MongoDB   â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ ×¡×§×¨×™×¤×˜×™×

```bash
npm run dev   # ×”×¤×¢×œ×” ×¢× hot reload (--watch)
npm start     # ×”×¤×¢×œ×” ×¨×’×™×œ×”
```

---

## ğŸ§ª ×‘×“×™×§×•×ª

```bash
cd tests
node --test index.test.js
```

---

## ğŸ“„ ×¨×™×©×™×•×Ÿ

ISC
